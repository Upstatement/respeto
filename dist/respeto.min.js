/*! respeto 12-12-2013 */
var Respeto=function(a){var b={imageDataAttribute:"rsp-img",imagePathAttribute:"rsp-path",imagePath:"",disableRetina:!1,retinaSuffix:"_x2"};this.settings=$.extend({},b,a),this._defaults=b,this._pixelRatio=window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1,this._scale=100,this._pixelRatio>1&&(this._scale=1/this._pixelRatio)};Respeto.prototype={load:function(a,b){b||(b={});var c=this._fetchTargets(b.match||void 0,b.exclude||void 0,b.context||document);this._reSource(c,a)},_reSource:function(a,b){var c=this;a.each(function(){var a=$(this),d=a.data(c.settings.imageDataAttribute);if(d){var e=a.data(c.settings.imagePathAttribute)||c.settings.imagePath,f=d.slice(-4),g=d.slice(0,-4),h=e+g+(b?"_"+b:"")+(c.settings.disableRetina?"":c.settings.retinaSuffix)+f;a.is("img")?a.attr("src",h):a.css("background-image","url("+h+")")}})},_fetchTargets:function(a,b,c){if(a)return $(c).find(a).not(b);var d="";for(var e in this.settings.searchTags)d+=this.settings.searchTags[e]+"[data-"+this.settings.imageDataAttribute+"]";return $(c).find("img[data-rsp-img],div[data-rsp-img]").not(b)}},"undefined"!=typeof module&&(module.exports=Respeto);